<!DOCTYPE html>
<html lang="en">
<head>  
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Demo parsing response with JavaScript</title>
</head>
<body >
    <button onclick="console.clear(), getBillDetails()">Click to exec getBillDetails(1, 1)</button>
    <button onclick="console.clear(), getCustomerList()">Click to exec getCustomerList()</button>
    <button onclick="console.clear(), getRoomCategories()">Click to exec getRoomCategories()</button>
    <button onclick="console.clear(), getRoomList()">Click to exec getRoomList()</button>
    <button onclick="console.clear(), updateSurcharge()">Click to exec updateSurcharge()</button>
</body>

<script>
    function getBillDetails() {
        var url = "ChiTietHoaDon.php" 
        + "?SoPhieuThue=" + '1'
        + "&SoHoaDon=" + '1';
        
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = onReceiveBillDetails;

        xhr.open("GET", url, true);
        xhr.send();
        console.log(url);
    }

    function onReceiveBillDetails() 
    {
        if (this.readyState == 4 && this.status == 200) 
        {
            var received = JSON.parse(this.responseText);
            
            if (received['success'])
            {
                var response = received['result'];
                
                for (let i = 0; i < response.length; i++)
                {
                    var details = response[i];
                    console.log(details);
                    
                    // Un-comment those to get specific data
                    // console.log(details['SoPhieuThue']);
                    // console.log(details['SoHoaDon']);
                    // console.log(details['SoNgayThueThuc']);
                    // console.log(details['TienThuePhong']);
                    // console.log(details['MaPhuThu']);
                }
            }
            else
            {
                console.log(received['message']);
            }
        }       
    }

    function getCustomerList () {
        var url = "DanhSachKhach.php";
        
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = onReceiveCustomerList;

        xhr.open("GET", url, true);
        xhr.send();
        console.log(url);
    }

    function onReceiveCustomerList() 
    {
        if (this.readyState == 4 && this.status == 200) 
        {
            var received = JSON.parse(this.responseText);
            
            if (received['success'])
            {
                var response = received['result'];
                
                for (let i = 0; i < response.length; i++)
                {
                    var customer = response[i];
                    console.log(customer);

                    // Un-comment those to get specific data
                    // console.log(customer['ID_KhachHang']);
                    // console.log(customer['LoaiKhach']);
                    // console.log(customer['HoTen']);
                    // console.log(customer['NgaySinh']);
                    // console.log(customer['DiaChi']);
                    // console.log(customer['SoDienThoai']);
                    // console.log(customer['CMND']);
                }
            }
            else
            {
                console.log(received['message']);
            }
        }       
    }

    function getRoomCategories() {
        var url = "DanhMucPhong.php";
        
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = onReceiveRoomCategories;

        xhr.open("GET", url, true);
        xhr.send();
        console.log(url);
    }

    function onReceiveRoomCategories() 
    {
        if (this.readyState == 4 && this.status == 200) 
        {
            var received = JSON.parse(this.responseText);
            
            if (received['success'])
            {
                var response = received['result'];
                
                for (let i = 0; i < response.length; i++)
                {
                    var roomCategory = response[i];
                    console.log(roomCategory);

                    // Un-comment those to get specific data
                    // console.log(roomCategory['MaLoai']);
                    // console.log(roomCategory['SoLuongPhong']);
                    // console.log(roomCategory['DonGia']);
                    // console.log(roomCategory['LuongKhachToiDa']);
                }
            }
            else
            {
                console.log(received['message']);
            }
        }       
    }

    function getRoomList() {
        var url = "DanhSachPhong.php";
        
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = onReceiveRoomList;

        xhr.open("GET", url, true);
        xhr.send();
        console.log(url);
    }

    function onReceiveRoomList() 
    {
        if (this.readyState == 4 && this.status == 200) 
        {
            var received = JSON.parse(this.responseText);
            
            if (received['success'])
            {
                var response = received['result'];
                
                for (let i = 0; i < response.length; i++)
                {
                    var room = response[i];
                    console.log(room);

                    // Un-comment those to get specific data
                    // console.log(room['MaPhong']);
                    // console.log(room['MaLoai']);
                    // console.log(room['TinhTrang']);
                    // console.log(room['GhiChu']);
                }
            }
            else
            {
                console.log(received['message']);
            }
        }       
    }

    function updateSurcharge() {
        var data = { 
            "MaPhuThu" : "PT01",
            "TiLeMoi" : Math.random()
        }; 

        var xhr = new XMLHttpRequest(); 
    
        xhr.onreadystatechange = onReceiveUpdateSurcharge;
    
        xhr.open("PUT", "ThayDoiPhuThu.php", true); 
        xhr.setRequestHeader('Content-Type', 'application/json'); 
        xhr.send(JSON.stringify(data)); 

        console.log(
            'PUT: ThayDoiPhuThu.php, data: ' 
            + JSON.stringify(data)
        );
    }

    function onReceiveUpdateSurcharge() 
    {
        if (this.readyState == 4 && this.status == 200) 
        {
            var received = JSON.parse(this.responseText);
            
            if (received['success'])
            {
                var response = received['result'];
                
                if (response.length == 0) 
                    console.log("No things was update");
                else
                    console.log("Changed: ");

                for (let i = 0; i < response.length; i++)
                {
                    var surcharge = response[i];
                    console.log(surcharge);

                    // Un-comment those to get specific data
                    // console.log(surcharge['MaPhong']);
                    // console.log(surcharge['MaLoai']);
                    // console.log(surcharge['TinhTrang']);
                    // console.log(surcharge['GhiChu']);
                }
            }
            else
            {
                console.log(received['message']);
            }
        }       
    }

</script>
</html>